!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).VSocketJs={})}(this,(function(e){"use strict";var t;!function(e){e[e.Ios=0]="Ios",e[e.Android=1]="Android",e[e.Web=2]="Web"}(t||(t={}));var r=new(function(){function e(){this.setupInternalUrlListener()}return e.prototype.submitData=function(e){var r=this;if(!e.length)throw new Error("received empty array");e.forEach((function(e){var t=r.objectIsValid(e);if(!t.valid)throw new Error(t.reason)}));var o={event:"externalData",data:e};switch(this.getPlatform()){case t.Ios:window.webkit.messageHandlers.visibaEmbeddedWebData.postMessage(o);break;case t.Android:prompt("JSInterface|"+JSON.stringify(o),"");break;case t.Web:window.top.postMessage(o,"*")}},e.prototype.returnToVisibaCare=function(e){void 0===e&&(e=null),this.getPlatform()===t.Web?window.top.postMessage({event:"exitIframe",data:e},"*"):window.location.href=e},e.prototype.setupInternalUrlListener=function(){var e=this;this.getPlatform()===t.Web&&window.addEventListener("beforeunload",(function(){var t=document.activeElement.href;e.returnToVisibaCare(t)}))},e.prototype.getPlatform=function(){var e=navigator.userAgent||navigator.vendor;return/android/i.test(e)?t.Android:/iPad|iPhone|iPod/.test(e)&&!window.MSStream?t.Ios:t.Web},e.prototype.objectIsValid=function(e){return e&&Object.keys(e).length?e.Type&&["keyvalue"].includes(e.Type)?e.Origin&&"string"==typeof e.Origin?e.Data?3!==Object.keys(e).length?{valid:!1,reason:"too many properties (allowed: Type, Origin, Data)"}:{valid:!0,reason:""}:{valid:!1,reason:"property Data required"}:{valid:!1,reason:"property Origin required. Type: string"}:{valid:!1,reason:"property Type required. Should be a valid type"}:{valid:!1,reason:"object not defined"}},e}());window.visiba=window.visiba||{},window.visiba.embeddedWebHelper=r,e.embeddedWebHelper=r,Object.defineProperty(e,"__esModule",{value:!0})}));
